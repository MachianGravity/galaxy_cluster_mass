<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PDF Image Index — Repository</title>
  <style>
    :root{--bg:#f6f8fb;--card:#fff;--accent:#61baed;--muted:#6b7280}
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto,"Helvetica Neue", Arial;color:#0f172a;background:var(--bg)}
    .wrap{display:flex;height:100vh;gap:20px}
    .sidebar{width:300px;background:linear-gradient(180deg,#ffffff 0%, #f8fafc 100%);box-shadow:0 6px 18px rgba(12,18,31,0.06);padding:18px 25px;overflow:auto;overflow-x: hidden;}
    .main{flex:1;padding:18px;overflow:auto}
    h1{margin:6px 0 6px;font-size:20px}
    p.lead{margin:0 0 12px;color:var(--muted)}
    .search{margin:12px 0}
    .search input{width:100%;padding:8px 10px;border-radius:8px;border:1px solid #e6e9ef}
    .list{margin-top:12px}
    .list a{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;text-decoration:none;color:inherit;margin-bottom:6px;border:1px solid transparent}
    .list :hover{background:#f1f5ff !important;}
    .download-btn{
    color:#fff;padding:6px 10px;border-radius:6px;text-decoration:none}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(480px,2fr));gap:16px}
    
    .card {
      background: var(--card);
      padding: 10px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(12,18,31,0.04);
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .preview img {
      width: 100%;   /* scale image to card width */
      height: auto;  /* maintain aspect ratio */
      border-radius: 8px;
      cursor: pointer;
    }
    .preview{flex:1;display:flex;align-items:center;justify-content:center;overflow:hidden;border-radius:8px;border:1px solid #eef2f7;background:#fafbff;cursor:pointer;position:relative;height:320px}
    .preview iframe{width:100%;height:100%;border:0;display:block}
    .preview .overlay{position:absolute;inset:0;background:transparent;cursor:pointer}
    .meta{margin-top:8px;display:flex;justify-content:space-between;align-items:center;width: 100%;}
    .filename{font-size:13px;color:#0b1222;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:85%}
    .muted{color:var(--muted);font-size:13px}
    .topbar{display:flex;gap:12px;align-items:center}

    /* Modal styles */
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,0.6);z-index:9999}
    .modal.open{display:flex}
    .modal-content{width:90%;max-width:1100px;height:85%;background:var(--card);border-radius:12px;box-shadow:0 10px 30px rgba(2,6,23,0.4);overflow:hidden;display:flex;flex-direction:column}
    .modal-header{padding:10px 14px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #eef2f7}
    .modal-title{font-size:15px}
    .modal-body{flex:1;display:flex;position:relative} /* position:relative so overlay can be positioned */
    .modal-body iframe{width:100%;height:100%;border:0}
    /* overlay that captures clicks on top of the iframe */
    .modal-click-close{position:absolute;inset:0;z-index:5;background:transparent;cursor:pointer}
    .modal-actions{padding:10px 14px;border-top:1px solid #eef2f7;display:flex;justify-content:flex-end;gap:8px}
    .btn{padding:8px 12px;border-radius:8px;border:0;cursor:pointer}
    .btn.secondary{background:#f1f5f9}
    .btn.primary{background:var(--accent);color:#fff}
    
    .download-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 4px;
      border-radius: 6px;
      color: #fff;
      text-decoration: none;
    }
    
    .download-btn svg {
      display: block;
    }
    
    @media (max-width:800px){.wrap{flex-direction:column}.sidebar{width:100%;height:auto}.main{padding:12px}.modal-content{width:98%;height:92%}}
  </style>
</head>
<body>
  <div class="wrap">
    <aside class="sidebar">
      <div class="topbar">
        <div>
          <h1>PDF Images — Repository</h1>
          <a href="https://machiangravity.github.io/Galactic-Velocity-Profile-/"> Home </a>
        </div>
      </div>

      <div class="search">
        <input id="search" placeholder="Filter filenames..." />
      </div>

      <div class="list" id="fileList"></div>

    </aside>

    <main class="main">
      <section>
        <h2 id="folderTitle">Tully Fisher Plot</h2>
        <a href="https://github.com/MachianGravity/Galactic-Velocity-Profile-/edit/main/Tully%20Fisher%20Plot" style="display: block; margin-bottom: 12px;" target="_blank">MachianGravity/Galactic-Velocity-Profile-/edit/main/Tully_Fisher_Plot</a>
        <p class="lead" id="folderDesc">The figure illustrates the relationship between mass discrepancy  to four variables: $r$, $v/r$, $a_N$, and $\lambda r$. These plots are based on a dataset comprising 2385 data points from the SPARC galaxies. None of the plots exhibit a very prominent correlation. Specifically, the top two plots display relatively weaker correlations and appear more dispersed, whereas the bottom two plots show relatively stronger correlations. 
      </section>

      <section style="margin-top:12px">
        <div id="grid" class="grid"></div>
      </section>
    </main>
  </div>

  <!-- Modal for large preview -->
  <div id="modal" class="modal" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true">
      <div class="modal-header">
        <div class="modal-title" id="modalTitle">Preview</div>
        <div>
          <button id="modalClose" class="btn secondary">Close</button>
        </div>
      </div>
      <div class="modal-body">
        <!-- overlay on top of iframe to capture clicks and close the modal -->
        <div class="modal-click-close" title="Click to close preview"></div>
        <iframe id="modalFrame" src="" title="PDF preview"></iframe>
      </div>
      <div class="modal-actions">
        <a id="modalDownload" class="btn primary" href="#" download>Download</a>
      </div>
    </div>
  </div>

  <script>
    const pdfFiles = [
    'MdMb_hist_pdf.pdf',
    'MdMb_vs_Mb_pdf.pdf',
    'MdMb_vs_Mbr2_pdf.pdf',
    'MdMb_vs_Mbr_pdf.pdf',
    'MdMb_vs_r_pdf.pdf',
    'Md_vs_Mb_pdf.pdf'
    ];

    const fileListEl = document.getElementById('fileList');
    const gridEl = document.getElementById('grid');
    const searchEl = document.getElementById('search');
    const togglePreviewBtn = document.getElementById('togglePreview'); // may be null if button not present
    const modal = document.getElementById('modal');
    const modalFrame = document.getElementById('modalFrame');
    const modalTitle = document.getElementById('modalTitle');
    const modalClose = document.getElementById('modalClose');
    const modalDownload = document.getElementById('modalDownload');
    const modalClickClose = document.querySelector('.modal-click-close');
    let previewsEnabled = true;

    function filenameFromPath(p){ return p.split('/').pop(); }

    function makeDownloadLink(path){
      const a = document.createElement('a');
      a.href = path;
      a.download = '';
      a.textContent = filenameFromPath(path);
      a.title = 'Download ' + filenameFromPath(path);
      return a;
    }

    function buildSidebar(list){
      fileListEl.innerHTML = '';
      if(list.length === 0){ fileListEl.innerHTML = '<div class="muted">No files matched.</div>'; return; }
      list.forEach(p => {
        const container = document.createElement('div');
        container.style.display = 'flex';
        container.style.justifyContent = 'space-between';
        container.style.alignItems = 'center';
        container.style.background = 'white';
        
        const a = makeDownloadLink(p);
        const btn = document.createElement('a');
        btn.href = p;
        btn.className = 'download-btn';
        btn.textContent = 'Download';
        btn.setAttribute('download','');

        container.appendChild(a);
        container.appendChild(btn);
        fileListEl.appendChild(container);
      });
    }

    function buildGrid(list){
      gridEl.innerHTML = '';
      list.forEach(p => {
        const card = document.createElement('div');
        card.className = 'card';

        const preview = document.createElement('div');
        preview.className = 'preview';

        // Use the corresponding PNG image for the preview (if you have them)
        const img = document.createElement('img');
        const imgName = p.replace('.pdf', '.png'); // Make sure names match exactly
        img.src = imgName;
        img.alt = filenameFromPath(p);
        img.addEventListener('click', () => openModal(p));
        preview.appendChild(img);

        const meta = document.createElement('div');
        meta.className = 'meta';
        const name = document.createElement('div');
        name.className = 'filename';
        name.textContent = filenameFromPath(p);

        const dl = document.createElement('a');
        dl.href = p;
        dl.className = 'download-btn';
        dl.setAttribute('download', '');
        dl.title = 'Download ' + filenameFromPath(p);
        dl.innerHTML = `
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="20" height="20">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M12 12v8m0 0l-4-4m4 4l4-4M12 4v8" />
        </svg>`;

        meta.appendChild(name);
        meta.appendChild(dl);

        card.appendChild(preview);
        card.appendChild(meta);
        gridEl.appendChild(card);
      });
    }

    function refresh(list){
      buildSidebar(list);
      buildGrid(list);
    }

    function openModal(filePath){
      modalTitle.textContent = filenameFromPath(filePath);
      modalFrame.src = filePath + '#page=1&zoom=auto';
      modalDownload.href = filePath;
      modal.classList.add('open');
      modal.setAttribute('aria-hidden','false');
    }

    function closeModal(){
      modal.classList.remove('open');
      modal.setAttribute('aria-hidden','true');
      modalFrame.src = '';
    }

    // initial render
    refresh(pdfFiles);

    // filter/search
    searchEl.addEventListener('input', (e)=>{
      const q = e.target.value.trim().toLowerCase();
      const filtered = pdfFiles.filter(p => filenameFromPath(p).toLowerCase().includes(q));
      refresh(filtered);
    });

    // togglePreview guard: only attach listener if element exists
    if (togglePreviewBtn) {
      togglePreviewBtn.addEventListener('click', ()=>{
        previewsEnabled = !previewsEnabled;
        document.querySelectorAll('.preview iframe').forEach(iframe => {
          iframe.style.display = previewsEnabled ? 'block' : 'none';
        });
        togglePreviewBtn.textContent = previewsEnabled ? 'Hide Previews' : 'Show Previews';
      });
    }

    // Close handlers
    if (modalClose) modalClose.addEventListener('click', closeModal);
    // clicking the overlay outside modal-content
    modal.addEventListener('click', (e) => { if(e.target === modal) closeModal(); });
    // clicking the transparent overlay on top of iframe closes modal
    if (modalClickClose) modalClickClose.addEventListener('click', closeModal);
    // escape key
    window.addEventListener('keydown', (e) => { if(e.key==='Escape' && modal.classList.contains('open')) closeModal(); });
  </script>
</body>
</html>
